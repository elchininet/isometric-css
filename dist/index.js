!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["isometric-css"]=e():t["isometric-css"]=e()}(this,(function(){return(()=>{"use strict";var t={158:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=r(37),i=r(539),a=r(995),s=function(){function t(){this._elements=new Map,this._classes=new Map,this._styles=new a.Styles}return t.prototype.removeClasses=function(t,e){t.classList.remove(e);var r=this._classes.get(e),n=r.findIndex((function(e){return e===t}));r.splice(n,1),0===r.length&&(this._classes.delete(e),this._styles.remove(e))},t.prototype.process=function(t,e){var r=this._elements.get(t),n=this._styles.getRuleData(e);if(r){if(r.selector===n.selector)return;this.removeClasses(t,r.selector)}t.classList.add(n.selector);var o=this._classes.get(n.selector);o?o.push(t):(this._styles.insert(n.selector,n.declaration),this._classes.set(n.selector,[t])),this._elements.set(t,{plane:e,selector:n.selector,rule:n.rule})},t.prototype.addElement=function(t){var e=i.getPlaneFromElement(t);this.process(t,e)},t.prototype.removeElement=function(t){i.resetElementIsometricData(t);var e=this._elements.get(t);e&&(this._elements.delete(t),this.removeClasses(t,e.selector))},t.prototype.setElementView=function(t,e){if(e===o.VIEW.top||e===o.VIEW.front||e===o.VIEW.side){var r=this._elements.get(t);this.process(t,r?n(n({},r.plane),{view:e}):{view:e,parentRotations:i.getParentRotations(t)})}},t.prototype.setElementPosition=function(t,e){if(+e.right||+e.left||+e.top){var r=this._elements.get(t);this.process(t,r?n(n({},r.plane),{position:n(n({},r.plane.position),e)}):{position:e,parentRotations:i.getParentRotations(t)})}},t.prototype.setElementRotation=function(t,e){if((e.axis===o.AXIS.right||e.axis===o.AXIS.left||e.axis===o.AXIS.top)&&+e.value){var r=this._elements.get(t);this.process(t,r?n(n({},r.plane),{rotation:e}):{rotation:e,parentRotations:i.getParentRotations(t)})}},t.prototype.setElementTexture=function(t,e){if(!("string"!=typeof e.url||e.size&&"string"!=typeof e.size||e.pixelated&&"boolean"!=typeof e.pixelated)){var r=this._elements.get(t);this.process(t,r?n(n({},r.plane),{texture:n(n({},r.plane.texture),e)}):{texture:e,parentRotations:i.getParentRotations(t)})}},t}();e.default=new s},995:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Styles=void 0;var o=r(821),i=r(37),a=r(821),s=r(854),l=r(361),u=function(){function t(){this._style=null,this.scale=s.round(i.SCALE),this.P50="50%",this.transformBefore="translate(-"+this.P50+", -"+this.P50+")",this.tranformAfterTop="translate(-"+this.P50+", "+this.P50+")",this.transformAfterFront="translate(-"+this.P50+", -"+this.P50+")",this.transformAfterSide="translate("+this.P50+", -"+this.P50+")",this.baseDeclarations={position:"absolute"},this.transformOriginDeclarations={transformOrigin:this.P50+" "+this.P50,MsTransformOrigin:this.P50+" "+this.P50,WebkitTransformOrigin:this.P50+" "+this.P50}}return Object.defineProperty(t.prototype,"sheet",{get:function(){return this._style?this._style.sheet:null},enumerable:!1,configurable:!0}),t.prototype.getTransform=function(t,e,r){var n=l.getViewMatrix(t,e,r);if(!n)return null;var o="matrix("+s.round(n[0][0])+","+s.round(n[1][0])+","+s.round(n[0][1])+","+s.round(n[1][1])+",0,0)",a=this.transformBefore+" "+o+" scale("+this.scale+")";switch(t){case i.VIEW.top:return a+" "+this.tranformAfterTop;case i.VIEW.front:return a+" "+this.transformAfterFront;case i.VIEW.side:return a+" "+this.transformAfterSide}},t.prototype.declarationString=function(t){var e=this;return Object.entries(t).reduce((function(t,r){return Array.isArray(r[1])?t+"\n    "+r[1].map((function(t){return e.declarationString(t)})).join("\n"):t+"\n    "+a.kebab(r[0])+": "+r[1]+";"}),"")},t.prototype.tranformPlaneToRule=function(t){var e=this.getTransform(t.view,t.parentRotations,t.rotation),r=e?n(n(n({},this.baseDeclarations),this.transformOriginDeclarations),{transform:e,MsTransform:e,WebkitTransform:e}):n({},this.baseDeclarations);if(t.position){var o=s.isometricToPoint(t.position,t.parentRotations);r.left=o.x+"px",r.top=o.y+"px"}return t.texture&&(r.backgroundImage='url("'+t.texture.url+'")',r.backgroundSize=t.texture.size||"cover",t.texture.pixelated&&(r.MsInterpolationMode="nearest-neighbor",r.imageRendering="pixelated",r.fallbacks=[{imageRendering:"crisp-edges"}])),r},t.prototype.init=function(){this._style=document.createElement("style"),this._style.dataset.isometric="",document.getElementsByTagName("head")[0].appendChild(this._style)},t.prototype.getRule=function(t){return this.tranformPlaneToRule(t)},t.prototype.getDeclarationString=function(t){return this.declarationString(t)},t.prototype.getSelector=function(t){return i.NAMESPACE+"-"+o.hash(t)},t.prototype.getRuleData=function(t){var e=this.getRule(t),r=this.getDeclarationString(e);return{rule:e,declaration:r,selector:this.getSelector(r)}},t.prototype.insert=function(t,e){this.sheet||this.init(),this.sheet.insertRule("."+t+" {\n"+e+"\n}")},t.prototype.remove=function(t){var e=this;Array.prototype.some.call(this.sheet.cssRules,(function(r,n){return!(!r||r.selectorText.slice(1)!==t||(e.sheet.deleteRule(n),0))}))},t}();e.Styles=u},37:(t,e)=>{var r,n;Object.defineProperty(e,"__esModule",{value:!0}),e.TYPE_UNDEFINED=e.AXIS=e.VIEW=e.ROT_CMA=e.ROT_45=e.ROT_60=e.SCALE=e.HSQRT3=e.DECIMALS=e.NAMESPACE=void 0,e.NAMESPACE="isometric",e.DECIMALS=6,e.HSQRT3=+(Math.sqrt(3)/2).toFixed(e.DECIMALS),e.SCALE=Math.sqrt(1.5),e.ROT_60=Math.PI/3,e.ROT_45=Math.PI/4,e.ROT_CMA=Math.atan(Math.SQRT2),(n=e.VIEW||(e.VIEW={})).top="top",n.front="front",n.side="side",(r=e.AXIS||(e.AXIS={})).right="right",r.left="left",r.top="top",e.TYPE_UNDEFINED="undefined"},607:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IsometricCSS=void 0;var n=r(37),o=r(158);e.IsometricCSS={processDOM:function(){Array.prototype.forEach.call(document.querySelectorAll("."+n.NAMESPACE),(function(t){o.default.addElement(t)}))},processElement:function(t){o.default.addElement(t)},resetElement:function(t){o.default.removeElement(t)},setView:function(t,e){o.default.setElementView(t,e)},setRotation:function(t,e){o.default.setElementRotation(t,e)},setPosition:function(t,e){o.default.setElementPosition(t,e)},setTexture:function(t,e){o.default.setElementTexture(t,e)}},typeof window!==n.TYPE_UNDEFINED&&typeof document!==n.TYPE_UNDEFINED&&(window.IsometricCSS=e.IsometricCSS,window.addEventListener("DOMContentLoaded",(function(){e.IsometricCSS.processDOM()})))},539:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.resetElementIsometricData=e.getPlaneFromElement=e.getParentRotations=void 0;var n=r(37);e.getParentRotations=function(t){for(var e=[];t.parentElement&&t.parentElement!==document.documentElement;){var r=t.parentElement;r.classList.contains(n.NAMESPACE)&&!r.dataset.view&&r.dataset.rotationAxis&&e.push({axis:r.dataset.rotationAxis,value:+(r.dataset.rotationValue||0)}),t=t.parentElement}return e},e.getPlaneFromElement=function(t){var r=t.dataset.view?t.dataset.view:null,n=+(t.dataset.right||0),o=+(t.dataset.left||0),i=+(t.dataset.top||0),a=t.dataset.rotationAxis?t.dataset.rotationAxis:null,s=+(t.dataset.rotationValue||0),l=t.dataset.texture,u=t.dataset.textureSize||"cover",c="true"===t.dataset.texturePixelated,f={parentRotations:e.getParentRotations(t)};return r&&(f.view=r),(n||o||i)&&(f.position={right:n,left:o,top:i}),a&&s&&(f.rotation={axis:a,value:s}),l&&(f.texture={url:l,size:u,pixelated:c}),f},e.resetElementIsometricData=function(t){t.classList.remove(n.NAMESPACE),function(t,e){["view","right","left","top","rotationAxis","rotationValue","texture","textureSize","texturePixelated"].forEach((function(e){t.dataset[e]&&delete t.dataset[e]}))}(t)}},854:function(t,e,r){var n=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.isometricToPoint=e.rotatePoint=e.sincos=e.radian=e.round=void 0;var o=r(37);e.round=function(t){var e=Math.pow(10,o.DECIMALS);return Math.round(t*e)/e},e.radian=function(t){return t*Math.PI/180},e.sincos=function(t){return{sin:e.round(Math.sin(t)),cos:e.round(Math.cos(t))}},e.rotatePoint=function(t,r,n){var o=Math.sqrt(Math.pow(t,2)+Math.pow(r,2)),i=Math.atan2(r,t)+e.radian(n);return{x:Math.cos(i)*o,y:Math.sin(i)*o}},e.isometricToPoint=function(t,r){var i=t.right,a=void 0===i?0:i,s=t.left,l=void 0===s?0:s,u=t.top,c=void 0===u?0:u;return r&&r.length&&n([],r).reverse().forEach((function(t){switch(t.axis){case o.AXIS.top:var r=e.rotatePoint(a,l,t.value);a=r.x,l=r.y;break;case o.AXIS.right:r=e.rotatePoint(l,c,t.value),l=r.x,c=r.y;break;case o.AXIS.left:r=e.rotatePoint(c,a,t.value),c=r.x,a=r.y}})),{x:e.round((a-l)*o.HSQRT3),y:e.round((a+l)/2-c)}}},361:function(t,e,r){var n=this&&this.__spreadArray||function(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.getViewMatrix=e.rotationToRotationMatrix=e.sideMatrix=e.frontMatrix=e.topMatrix=e.rotateZ=e.rotateY=e.rotateX=e.multiplyMatrices=e.multiplyMatrix=void 0;var o=r(37),i=r(854);e.multiplyMatrix=function(t,e){return t.map((function(r,n){return e[0].map((function(o,i){return r.reduce((function(r,o,a){return r+t[n][a]*e[a][i]}),0)}))}))},e.multiplyMatrices=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t[0],o=1;o<t.length;o++)n=e.multiplyMatrix(n,t[o]);return n},e.rotateX=function(t){var e=i.sincos(t);return[[1,0,0],[0,e.cos,-e.sin],[0,e.sin,e.cos]]},e.rotateY=function(t){var e=i.sincos(t);return[[e.cos,0,e.sin],[0,1,0],[-e.sin,0,e.cos]]},e.rotateZ=function(t){var e=i.sincos(t);return[[e.cos,-e.sin,0],[e.sin,e.cos,0],[0,0,1]]},e.topMatrix=e.multiplyMatrices(e.rotateX(o.ROT_CMA),e.rotateZ(-o.ROT_45)),e.frontMatrix=e.multiplyMatrices(e.rotateZ(-o.ROT_60),e.rotateX(o.ROT_CMA),e.rotateZ(o.ROT_45)),e.sideMatrix=e.multiplyMatrices(e.rotateZ(o.ROT_60),e.rotateX(o.ROT_CMA),e.rotateZ(-o.ROT_45)),e.rotationToRotationMatrix=function(t,r){var n=i.radian(r.value);switch(t){case o.VIEW.top:switch(r.axis){case o.AXIS.top:return e.rotateZ(n);case o.AXIS.left:return e.rotateX(-n);case o.AXIS.right:return e.rotateY(n);default:return null}case o.VIEW.front:switch(r.axis){case o.AXIS.top:return e.rotateY(n);case o.AXIS.left:return e.rotateX(n);case o.AXIS.right:return e.rotateZ(n);default:return null}case o.VIEW.side:switch(r.axis){case o.AXIS.top:return e.rotateY(n);case o.AXIS.left:return e.rotateZ(n);case o.AXIS.right:return e.rotateX(-n);default:return null}default:return null}},e.getViewMatrix=function(t,r,i){var a=[];r.forEach((function(r){var n=e.rotationToRotationMatrix(t,r);n&&a.push(n)}));var s=i?e.rotationToRotationMatrix(t,i):null;switch(s&&a.push(s),t){case o.VIEW.top:return e.multiplyMatrices.apply(void 0,n([e.topMatrix],a));case o.VIEW.front:return e.multiplyMatrices.apply(void 0,n([e.frontMatrix],a));case o.VIEW.side:return e.multiplyMatrices.apply(void 0,n([e.sideMatrix],a))}return null}},821:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.hash=e.kebab=void 0,e.kebab=function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},e.hash=function(t){for(var e,r=0,n=0,o=t.length;o>=4;++n,o-=4)e=1540483477*(65535&(e=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+(59797*(e>>>16)<<16),r=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&t.charCodeAt(n+2))<<16;case 2:r^=(255&t.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}}},e={};return function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}(607)})()}));